---
output: github_document
number_sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=12, fig.height=7.5)

library(data.table)
library(sp)
library(ggplot2)
library(scico)

gfcov <- readRDS(paste0("~/floodGAM/data/processed-data/","gamfelt/",
                       "gamfelt_catchment_covariates.rds"))
load(paste0("~/floodGAM/data/processed-data/","gamfelt/",
            "README_files/","station_selection_map_datafiles.rda"))
NorgeDF <- fortify(Norge)
```


<h1 align="center">The gamfelt dataset</h1>

This folder contains the annual maxima and catchment descriptors for the `gamfelt` dataset. We summarize some properties of the dataset below.

## File structure

 - `gamfelt_annual_maxima` - the annual maxima, in $m^3/s$.
 - `gamfelt_catchment_descriptors` - catchment descriptors for each gamfelt station. 
 - `README-catchment-descriptors.txt` - description of each variable in the catchment descriptor dataset.


## Describing the dataset

The `gamfelt` dataset contains annual maxima for 249 stations in Norway. Each station has at least 20 years of total data and 10 years of sub-daily (fine) data. Each year of data has been assessed using the process described in the [data README](/data/README.md). 

The stations represent a reasonably diverse collection of catchment sizes and hydroclimatic regimes:

```{r,echo=F,warning=F,message=F}
scaleFUN <- function(x) sprintf("%.1f", x) # to get good fraction of rain labels

gfgp <- ggplot() +
  geom_polygon(data=NorgeDF,aes(long,lat,group=group),
               fill = "white",color="grey",alpha=0.3) +
  geom_point(data=gfcov,aes(X_utm,Y_utm,
                                fill=QD_fgp,
                                size=A),
             color="black",
             inherit.aes = FALSE,
             pch=21,stroke=0.1) +
  scale_fill_scico(name = "Fraction of rain\ncontribution to\nflood generating process",
                   palette = "lapaz",end=0.9,
                   alpha=1) +
  scale_size_continuous(name = expression(paste("Catchment area [", km^2, "]",
                                                sep = "")) ,
                        range=c(1.5,12),
                        breaks = c(10,500,2000))+
  coord_equal()+
  theme_void() +
  theme(legend.position = c(0.65,0.29),
        text = element_text(family="sans"))
gfgp
```

| Catchment area ($km^2$)  | 0 - 2 $km^2$ | 2 - 10 $km^2$ | 10 - 60 $km^2$ | 60 - 100 $km^2$ | 100 - 500 $km^2$ | 500+ $km^2$ |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: |
| **Number of stations** | 2 | 18 | 67 | 27 | 94 | 39 |

The mean annual runoff for the stations ranges from around 8 $l/s/km^2$ to about 145 $l/s/km^2$.

```{r,echo=F, warning=FALSE,message=FALSE,fig.dim=c(6,4),fig.align='center'}
ggplot(gfcov) +
  geom_histogram(aes(Q_N),fill="darkgrey",color="black") +
  labs(y = "Number of stations",
       x = "Mean annual runoff 1961-1990 (l/s/km2)") + 
  theme_bw()
```



## How fine is "fine data"?
